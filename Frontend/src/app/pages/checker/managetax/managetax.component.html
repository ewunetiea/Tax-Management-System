<main id="main" class="main">
    <p-toast></p-toast>
    <div class="mb-6">
      <p-breadcrumb class="max-w-full" [model]="items" [home]="home"></p-breadcrumb>
  </div>

    <div class="row">
      <div class="col-lg-12">
        <p-card>
          <p-toolbar styleClass="p-mb-4">
            <ng-template pTemplate="left">
              <button
                pButton
                pRipple
                label="Review"
                icon="pi pi-verified"
                class="p-button-rounded p-button-outlined p-button-success mr-2 "
                (click)="reviewSelectedTaxes()"
                [disabled]="!selectedTaxes || !selectedTaxes.length"
              ></button>
            </ng-template>

            <ng-template pTemplate="right">
              <div class="flex">
                
              </div>
            </ng-template>
          </p-toolbar>

          <p-table
            #dt
            [value]="taxes"
            [rows]="5"
            [paginator]="true"
            [loading]="loading"
            [globalFilterFields]="[
              'mainGuid',
              'from_',
              'sendTo_',
              'taxCategory',
              'noOfEmployee',
              'taxableAmount',
              'taxWithHold',
              'incometaxPoolAmount',
              'graduatetaxPool',
              'graduatetaxPool1',
              'graduaTotBasSalary',
              'graduateTotaEmployee',
              'graduatetaxWithHold',
              'taxCategoryList',
              'maker_name',
              'maker_date',
              'checker_name',
              'checked_Date',
              'updated_user_name',
              'updated_event_date',
              'from_List',
              'sendTo_List',
              'Category_List',
              'FileDetail',
              'status'
            ]"
            [(selection)]="selectedTaxes"
            [rowHover]="true"
            dataKey="id"
            [rowsPerPageOptions]="[5,10, 25, 50]"
            [size]="selectedSize"
            [tableStyle]="{ 'min-width': '250rem' }"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [showCurrentPageReport]="true"
          >
          <ng-template #caption>
            <div class="flex items-center justify-between">
                <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt)"></button>
                <div class="flex justify-center mb-4">
                    <p-selectbutton [options]="sizes" [(ngModel)]="selectedSize" [multiple]="false" optionLabel="name" optionValue="value" />
                </div>
                <p-iconfield>
                    <p-inputicon styleClass="pi pi-search" />
                    <input pInputText type="text" (input)="onGlobalFilter(dt, $event)" placeholder="Search..." />
                </p-iconfield>
            </div>
        </ng-template>
            <ng-template pTemplate="header">
              <tr>
                <!-- <th style="width: 3rem"></th> -->
                <th style="width: 3rem">
                  <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                </th>

                <th style="min-width: 10rem">
                  <div class="flex items-center">
                      From
                      <p-columnFilter type="numeric" field="from_" display="menu" />
                  </div>
                </th>

              <th style="min-width: 10rem">
                <div class="flex items-center">
                    To
                    <p-columnFilter type="numeric" field="sendTo_" display="menu" />
                </div>
              </th>

            <th style="min-width: 10rem">
              <div class="flex items-center">
                Tax Category
                  <p-columnFilter type="numeric" field="taxCategory" display="menu" />
              </div>
            </th>

            <th style="min-width: 10rem">
              <div class="flex items-center">
                  Number of Employee
                  <p-columnFilter type="numeric" field="noOfEmployee" display="menu" />
              </div>
            </th>

            <th style="min-width: 10rem">
              <div class="flex items-center">
                Taxable Amount
                  <p-columnFilter type="numeric" field="taxableAmount" display="menu" />
              </div>
            </th>

             <th style="min-width: 10rem">
              <div class="flex items-center">
                Tax With Hold
                  <p-columnFilter type="numeric" field="taxWithHold" display="menu" />
              </div>
            </th>

             <th style="min-width: 10rem">
              <div class="flex items-center">
                Graduate Tax Pool
                  <p-columnFilter type="numeric" field="graduatetaxPool" display="menu" />
              </div>
            </th>

             <th style="min-width: 10rem">
              <div class="flex items-center">
                Graduate Tax Pool1
                  <p-columnFilter type="numeric" field="graduatetaxPool1" display="menu" />
              </div>
            </th>

             <th style="min-width: 10rem">
              <div class="flex items-center">
                Graduate Base Salary
                  <p-columnFilter type="numeric" field="graduaTotBasSalary" display="menu" />
              </div>
            </th>

             <th style="min-width: 10rem">
              <div class="flex items-center">
                Graduate Total Employee
                  <p-columnFilter type="numeric" field="graduateTotaEmployee" display="menu" />
              </div>
            </th>

             <th style="min-width: 10rem">
              <div class="flex items-center">
                Graduate Tax With Hold
                  <p-columnFilter type="numeric" field="graduatetaxWithHold" display="menu" />
              </div>
            </th>

            <th style="min-width: 10rem">
              <div class="flex items-center">
                Maker Name
                  <p-columnFilter type="text" field="maker_name" display="menu" />
              </div>
            </th>


            <th style="min-width: 10rem">
              <div class="flex items-center">
                Maker Date
                  <p-columnFilter type="date" field="maker_date" display="menu" />
              </div>
            </th>

            <th style="min-width: 10rem">
              <div class="flex items-center">
                Checked By
                  <p-columnFilter type="text" field="checker_name" display="menu" />
              </div>
            </th>

            <th style="min-width: 10rem">
              <div class="flex items-center">
                Checked Date
                  <p-columnFilter type="date" field="checked_Date" display="menu" />
              </div>
            </th>

            <th style="min-width: 10rem">
              <div class="flex items-center">
                Updated By
                  <p-columnFilter type="text" field="updated_user_name" display="menu" />
              </div>
            </th>

            <th style="min-width: 10rem">
              <div class="flex items-center">
                Updated Date
                  <p-columnFilter type="date" field="updated_event_date" display="menu" />
              </div>
            </th>

            <th style="width: 12rem">Action</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-tax let-expanded="expanded">
              <tr>
                <td>
                  <p-tableCheckbox [value]="tax"></p-tableCheckbox>
                </td>
                <td>{{ tax.from_ }}</td>
                <td>{{ tax.sendTo_ }}</td>
                <td>{{ tax.taxCategory}}</td>
                <td>{{tax.noOfEmployee}}</td>
                <td>{{ tax.taxableAmount | number:'1.0-2' }}</td>
                <td>{{tax.taxWithHold | number:'1.0-2'}}</td>
                <td>{{tax.graduatetaxPool | number:'1.0-2'}}</td>
                <td>{{tax.graduatetaxPool1 | number:'1.0-2' }}</td>
                <td>{{tax.graduaTotBasSalary | number:'1.0-2' }}</td>
                <td>{{tax.graduateTotaEmployee | number:'1.0-2'}}</td>
                <td>{{tax.graduatetaxWithHold | number:'1.0-2' }}</td>
                <td>{{tax.maker_name}}</td>
                <td>{{ tax.maker_date | date:'yyyy-MM-dd' }}</td>
                <td>
                   <ng-container *ngIf="tax.checker_name; else pendingBtn">
                    {{ tax.checker_name }}
                  </ng-container>
                  <ng-template #pendingBtn>
                    <button 
                    pButton 
                    pRipple 
                    type="text" 
                    label="Unchecked" 
                    class="p-button-rounded p-button-secondary p-button-outlined p-button-sm"
                    ></button>
                  </ng-template>
                </td>
                <td>
                   <ng-container *ngIf="tax.checked_Date; else pendingBtn">
                    {{ tax.checked_Date | date:'yyyy-MM-dd' }}
                  </ng-container>
                  <ng-template #pendingBtn>
                    <button 
                    pButton 
                    pRipple 
                    type="text" 
                    label="Unchecked" 
                    class="p-button-rounded p-button-secondary p-button-outlined p-button-sm"
                    ></button>
                  </ng-template>
                </td>
                <td>
                   <ng-container *ngIf="tax.updated_user_name; else pendingBtn">
                    {{ tax.updated_user_name }}
                  </ng-container>
                  <ng-template #pendingBtn>
                    <button 
                    pButton 
                    pRipple 
                    type="text" 
                    label="Unupdated" 
                    class="p-button-rounded p-button-secondary p-button-outlined p-button-sm"
                    ></button>
                  </ng-template>
                </td>
                <td>
                   <ng-container *ngIf="tax.updated_event_date; else pendingBtn">
                    {{ tax.updated_event_date | date:'yyyy-MM-dd' }}
                  </ng-container>
                  <ng-template #pendingBtn>
                    <button 
                    pButton 
                    pRipple 
                    type="text" 
                    label="Unupdated" 
                    class="p-button-rounded p-button-secondary p-button-outlined p-button-sm"
                    ></button>
                  </ng-template>
                </td>
                <td>
                  <button
                    pButton
                    pRipple
                    pTooltip="Edit"
                    tooltipPosition="bottom"
                    (click)="editTax(tax)"
                    icon="pi pi-pencil"
                    class="p-button-rounded p-button-outlined p-button-info mr-2"
                  ></button>
                  <button
                    pButton
                    pRipple
                    pTooltip="Review"
                    tooltipPosition="bottom"
                    (click)="reviewTax(tax)"
                    icon="pi pi-verified"
                    class="p-button-rounded p-button-outlined p-button-success mr-2"
                  ></button>
                  <button
                    pButton
                    pRipple
                    pTooltip="Reject"
                    tooltipPosition="bottom"
                    (click)="reviewTax(tax)"
                    icon="pi pi-times-circle"
                    class="p-button-rounded p-button-outlined p-button-danger"
                  ></button>
                </td>
              </tr>
            </ng-template>

            <ng-template pTemplate="summary">
              <div class="p-d-flex p-ai-center p-jc-between">
                In total there are {{ taxes ? taxes.length : 0 }} taxes.
              </div>
            </ng-template>
          </p-table>
        </p-card>
      </div>
    </div>
</main>

<p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>
