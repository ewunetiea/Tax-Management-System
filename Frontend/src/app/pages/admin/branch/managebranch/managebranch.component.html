<main id="main" class="main">
    <p-toast></p-toast>
    <div class="mb-6">
      <p-breadcrumb class="max-w-full" [model]="items" [home]="home"></p-breadcrumb>
  </div>
    <section class="section">
      <div class="row">
        <div class="col-lg-12">
          <p-card>
            <!-- <p-toolbar styleClass="p-mb-4">
              <ng-template pTemplate="left">
                <button
                  pButton
                  pRipple
                  label="New"
                  (click)="openNew()"
                  icon="pi pi-plus"
                  class="p-button-rounded p-button-outlined mr-2"
                ></button>
                <button
                  pButton
                  pRipple
                  label="Deactivate"
                  icon="pi pi-times"
                  class="p-button-rounded p-button-outlined p-button-danger mr-2"
                  (click)="deleteSelectedBranches()"
                  [disabled]="!selectedBranches || !selectedBranches.length"
                ></button>
                <button
                  pButton
                  pRipple
                  label="Activate"
                  icon="pi pi-verified"
                  class="p-button-rounded p-button-outlined p-button-success"
                  (click)="activateSelectedBranches()"
                  [disabled]="!selectedBranches || !selectedBranches.length"
                ></button>
              </ng-template>
  
              <ng-template pTemplate="right">
                <div class="flex">
                  
                </div>
              </ng-template>
            </p-toolbar> -->
  
            <p-table
              #dt
              [value]="branches"
              [rows]="5"
              [paginator]="true"
              [loading]="loading"
              [globalFilterFields]="[
                'name',
                'code',
                'status',
                'region',
              ]"
              [(selection)]="selectedBranches"
              [rowHover]="true"
              dataKey="id"
              [rowsPerPageOptions]="[5,10, 25, 50]"
              [size]="selectedSize"
              [tableStyle]="{ 'min-width': '82rem' }"
              currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
              [showCurrentPageReport]="true"
            >
            <ng-template #caption>
              <div class="flex items-center justify-between">
                  <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt)"></button>
                  <div class="flex justify-center mb-4">
                      <p-selectbutton [options]="sizes" [(ngModel)]="selectedSize" [multiple]="false" optionLabel="name" optionValue="value" />
                  </div>
                  <p-iconfield>
                      <p-inputicon styleClass="pi pi-search" />
                      <input pInputText type="text" (input)="onGlobalFilter(dt, $event)" placeholder="Search..." />
                  </p-iconfield>
              </div>
          </ng-template>
              <ng-template pTemplate="header">
                <tr>
                  <!-- <th style="width: 3rem"></th> -->
                  <th style="width: 3rem">
                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                  </th>

                  <th style="min-width: 15rem">
                    <div class="flex items-center">
                        Name
                        <p-columnFilter type="text" field="name" display="menu" />
                    </div>
                  </th>

                <th style="min-width: 15rem">
                  <div class="flex items-center">
                      Code
                      <p-columnFilter type="text" field="code" display="menu" />
                  </div>
                </th>
  
              <th style="min-width: 15rem">
                <div class="flex items-center">
                    Region
                    <p-columnFilter type="text" field="region" display="menu" />
                </div>
              </th>
  
              <th style="min-width: 15rem">
                <div class="flex items-center">
                    Status
                    <p-columnFilter type="numeric" field="status" display="menu" />
                </div>
              </th>
              
              <th style="width: 15rem">Action</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-branch let-expanded="expanded">
                <tr>
                  <!-- <td>
                    <button
                      type="button"
                      pButton
                      pRipple
                      [pRowToggler]="role"
                      class="p-button-text p-button-rounded p-button-plain"
                      [icon]="
                        expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'
                      "
                    ></button>
                  </td> -->
                  <td>
                    <p-tableCheckbox [value]="branch"></p-tableCheckbox>
                  </td>
                  <td>{{ branch.name }}</td>
                  <td>{{ branch.code }}</td>
                  <td>{{ branch.region.name }}</td>
                  <td>
                    <button
                      *ngIf="branch.status ==1"
                      pButton
                      pRipple
                      type="text"
                      icon="pi pi-verified"
                      label="Active"
                      class="p-button-rounded p-button-success p-button-outlined"
                    ></button>
  
                    <button
                      *ngIf="branch.status == 0"
                      pButton
                      pRipple
                      type="text"
                      icon="pi pi-times"
                      label="Inactive"
                      class="p-button-rounded p-button-danger p-button-outlined"
                    ></button>
                  </td>
  
                  <td>
                    <button
                      pButton
                      pRipple
                      pTooltip="Edit"
                      tooltipPosition="bottom"
                      (click)="editBranch(branch)"
                      icon="pi pi-pencil"
                      class="p-button-rounded p-button-outlined mr-2"
                    ></button>
                    <button
                      *ngIf="branch.status == 1"
                      pButton
                      pRipple
                      pTooltip="Deactivate"
                      tooltipPosition="bottom"
                      (click)="deleteBranch(branch)"
                      icon="pi pi-times"
                      class="p-button-rounded p-button-outlined p-button-danger mr-2"
                    ></button>
                    <button
                      *ngIf="branch.status == 0"
                      pButton
                      pRipple
                      pTooltip="Activate"
                      tooltipPosition="bottom"
                      (click)="activateBranch(branch)"
                      icon="pi pi-verified"
                      class="p-button-rounded p-button-outlined p-button-secondary"
                    ></button>
                  </td>
                </tr>
              </ng-template>
  
              <ng-template pTemplate="summary">
                <div class="p-d-flex p-ai-center p-jc-between">
                  In total there are {{ branches ? branches.length : 0 }} branches.
                </div>
              </ng-template>
            </p-table>
          </p-card>
        </div>
      </div>
    </section>
  </main>
  
  <p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>

  <p-dialog
    [(visible)]="branchEditDialog"
    [style]="{ width: '600px' }"
    header="Branch Details"
    [modal]="true"
    styleClass="p-fluid"
    [maximizable]="true"
  >
    <ng-template pTemplate="content">
      <app-create-edit-branch
        [passedBranch]="outputBranch"
        (editedBranch)="onDataChange($event)"
      ></app-create-edit-branch>
    </ng-template>
  </p-dialog>
  
  <p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>